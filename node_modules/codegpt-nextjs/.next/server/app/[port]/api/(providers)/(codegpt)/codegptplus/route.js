"use strict";(()=>{var e={};e.id=6263,e.ids=[6263],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},2274:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>w,requestAsyncStorage:()=>q,routeModule:()=>y,serverHooks:()=>P,staticGenerationAsyncStorage:()=>v});var o={};r.r(o),r.d(o,{GET:()=>m,HEAD:()=>h,POST:()=>f});var s=r(49303),a=r(88716),n=r(60670),p=r(20021),i=r(56342),u=r(76129),d=r(51414),l=r(94750),c=r(73626),g=r(16292),x=r(80050);async function h(){return Response.json("",{status:p.Xd?.apiKey?200:401})}async function m(){if(p.Xd?.config?.apiKey?.toLowerCase()!=="codegpt plus")return Response.json("Oops! The selected model has a potential configuration conflict. Please ensure that all your open instances of VSCode have the same provider.",{status:400});try{let e=await x.Z.get("https://plus.codegpt.co/api/v1/agent/",{headers:{Authorization:`Bearer ${p.Xd.apiKey}`,"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}});return Response.json(e.data)}catch(e){return console.log(e),Response.json(e.message,{status:e.status??500})}}async function f(e){if(p.Xd?.config?.apiKey?.toLowerCase()!=="codegpt plus")return Response.json("Oops! The selected model has a potential configuration conflict. Please ensure that all your open instances of VSCode have the same provider.",{status:400});let{messages:t}=await e.json();t=(0,c.D)({messages:t});let r=e.headers.get("model"),o=e.headers.get("promptType"),s=await l.Z.getLanguage(),a=await l.Z.getIdeLanguage(),n="Chat";if(o){n=t[t.length-1].content+"CodeGPT";let e=(0,u.u)({promptType:t[t.length-1].content,cleanPromptText:await l.Z.getSelectedText(),language:a});e&&(t[t.length-1].content=e)}let x=await l.Z.getSelectedText();x&&(t[t.length-1].content+="\n```"+s+"\n"+x+"\n```");let h=p.Xd?.globalState?.config,m=JSON.stringify({messages:t,max_tokens:h?.maxTokens||1500,temperature:h?.temperature||.3}),f="Plus"===r;try{if(!p.Xd.apiKey){let e=Error("You need to set your API key first.");throw e.status=401,e}r=f?"":r;let e=await fetch(`https://plus.codegpt.co/api/v1/agent${r&&"undefined"!==r?`/${r}`:""}`,{method:"POST",headers:{Authorization:`Bearer ${p.Xd.apiKey}`,"Content-Type":"application/json"},body:m});(0,i.q)({eventName:n,provider:"CodeGPT Plus",model:f?"gpt-3.5-turbo":"agentId: "+r,statusCode:e.status});let a=(0,g.t2)(e,e=>JSON.parse(e).data,void 0),u=t.slice(0,-1).some(e=>e.content.includes(x));if(x&&(o||!u)){let e=await (0,d.V)(["```"+s+"\n"+x+"\n```"],a);return new g.wn(e)}return new g.wn(a)}catch(e){return(0,i.q)({eventName:n,provider:"CodeGPT Plus",model:f?"gpt-3.5-turbo":"agentId: "+r,statusCode:e.status}),Response.json({message:e.message,status:e.status??500},{status:e.status??500})}}let y=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/[port]/api/(providers)/(codegpt)/codegptplus/route",pathname:"/[port]/api/codegptplus",filename:"route",bundlePath:"app/[port]/api/(providers)/(codegpt)/codegptplus/route"},resolvedPagePath:"/Users/maol/WebstormProjects/Trabajo/codegpt-nextjs/app/[port]/api/(providers)/(codegpt)/codegptplus/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:q,staticGenerationAsyncStorage:v,serverHooks:P}=y,j="/[port]/api/(providers)/(codegpt)/codegptplus/route";function w(){return(0,n.patchFetch)({serverHooks:P,staticGenerationAsyncStorage:v})}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,1203,50,3306,6292,464],()=>r(2274));module.exports=o})();